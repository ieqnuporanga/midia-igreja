<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Checklist da Transmiss√£o | IEQ Nuporanga</title>
  <meta name="description" content="Checklist simples para a equipe de m√≠dia iniciar, acompanhar e encerrar a transmiss√£o ao vivo." />
  <meta name="theme-color" content="#060A12" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900;950&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#060A12;
      --panel: rgba(255,255,255,.07);
      --panel2: rgba(255,255,255,.10);
      --line: rgba(255,255,255,.14);
      --text: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.74);

      --red:#FF0000;
      --yellow:#FFCC00;
      --blue:#00B2FF;
      --purple:#6600FF;

      --max: 980px;
      --r24: 24px;
      --padX: 18px;
    }

    *{box-sizing:border-box}
    html{
      scroll-behavior:auto;
      height:100%;
      background:#060A12;
      overscroll-behavior: none;
    }

    body{
      margin:0;
      min-height:100%;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: linear-gradient(180deg, #070B14, #050812);
      color:#fff;
      line-height:1.65;
      overflow-x:hidden;
      text-rendering: optimizeLegibility;
    }

    a{color:inherit;text-decoration:none}
    .container{max-width:var(--max);margin:0 auto;padding:0 var(--padX)}
    .kickerBar{
      height:6px;border-radius:999px;
      background: linear-gradient(90deg, var(--red), var(--yellow), var(--blue), var(--purple));
      width: 160px;margin: 18px 0 14px;
    }

    header{
      position:sticky;top:0;z-index:50;
      backdrop-filter: blur(10px);
      background: rgba(6,10,18,.82);
      border-bottom:1px solid rgba(255,255,255,.10);
    }
    .head{
      display:flex;align-items:center;justify-content:space-between;
      gap:12px;
      padding:12px 0;
      flex-wrap:wrap;
    }
    .brand{
      display:flex;align-items:center;gap:12px;min-width:0;
    }
    .logo{
      width:42px;height:42px;border-radius:14px;overflow:hidden;flex:0 0 auto;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      display:grid;place-items:center;
    }
    .logo img{width:100%;height:100%;object-fit:cover}
    .brandTxt{min-width:0}
    .brandTxt strong{
      display:block;
      font-weight:950;letter-spacing:-.3px;
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
      max-width: 64vw;
    }
    .brandTxt span{
      display:block;
      font-size:12.5px;
      font-weight:900;
      color: rgba(255,255,255,.70);
      white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
      max-width: 64vw;
      margin-top:2px;
    }

    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:10px;
      font-size:13.5px;font-weight:950;
      padding:10px 12px;border-radius:999px;
      border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.08);
      color: rgba(255,255,255,.95);
      cursor:pointer;user-select:none;
      transition: transform .12s ease, background .12s ease, border-color .12s ease;
      white-space:nowrap;
    }
    .btn:hover{transform:translateY(-1px);background: rgba(255,255,255,.12);border-color: rgba(255,255,255,.22)}
    .btn.primary{
      background: rgba(255,255,255,.14);
      border-color: rgba(255,255,255,.26);
    }
    .btn.danger{
      background: rgba(255,0,0,.12);
      border-color: rgba(255,0,0,.22);
    }
    .btn.ghost{background: rgba(255,255,255,.06)}
    .btn.small{
      padding:8px 10px;
      font-size:12.8px;
    }

    main{padding: 14px 0 36px}

    .hero{padding: 10px 0 14px;}
    h1{
      margin:0 0 6px;
      font-size:28px;
      letter-spacing:-.9px;
      line-height:1.15;
      font-weight:950;
    }
    .sub{
      margin:0;
      color: rgba(255,255,255,.80);
      font-size:15px;
      max-width: 80ch;
    }

    .panel{
      margin-top:16px;
      border:1px solid var(--line);
      background: var(--panel);
      border-radius: var(--r24);
      box-shadow: 0 16px 40px rgba(0,0,0,.30);
      overflow:hidden;
    }
    .panelTop{
      padding:14px 16px;
      display:flex;align-items:flex-start;justify-content:space-between;gap:12px;
      background: rgba(0,0,0,.12);
      border-bottom:1px solid rgba(255,255,255,.10);
      flex-wrap:wrap;
    }
    .panelTop .left strong{
      display:block;
      font-weight:950;
      letter-spacing:-.2px;
      margin-bottom:2px;
    }
    .panelTop .left span{
      color: rgba(255,255,255,.72);
      font-weight:900;
      font-size:12.5px;
    }
    .panelBody{padding: 6px 16px 16px}

    .step{
      margin-top:12px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(255,255,255,.05);
      border-radius: 18px;
      overflow:hidden;
    }
    .stepHead{
      padding:12px 12px;
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      border-bottom:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.04);
      cursor:pointer;
    }
    .stepHead h2{
      margin:0;
      font-size:15px;
      font-weight:950;
      letter-spacing:-.2px;
      color: rgba(255,255,255,.92);
    }
    .stepHead .meta{
      display:flex;align-items:center;gap:10px;flex-wrap:wrap;
      color: rgba(255,255,255,.70);
      font-weight:900;
      font-size:12.5px;
      user-select:none;
    }
    .chip{
      display:inline-flex;align-items:center;justify-content:center;
      padding:6px 10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.16);
      color: rgba(255,255,255,.86);
      font-weight:950;
      font-size:12px;
    }
    .chip.ok{
      background: rgba(0,255,140,.10);
      border-color: rgba(0,255,140,.20);
    }

    .stepBody{padding: 12px}
    .items{display:grid;gap:10px}

    label.item{
      display:flex;gap:10px;align-items:flex-start;
      padding:10px 10px;
      border:1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18);
      border-radius: 16px;
      cursor:pointer;
    }
    input[type="checkbox"]{
      width:18px;height:18px;
      margin-top:2px;
      accent-color: #8b5cff;
      flex:0 0 auto;
    }
    .txtWrap{min-width:0}
    .txt{
      font-size:14px;
      color: rgba(255,255,255,.90);
      font-weight:800;
      line-height:1.45;
    }
    .hint{
      margin-top:6px;
      font-size:12.5px;
      color: rgba(255,255,255,.70);
      font-weight:700;
      line-height:1.45;
      padding:8px 10px;
      border-radius:12px;
      background: rgba(255,255,255,.05);
      border:1px dashed rgba(255,255,255,.14);
    }

    .footerRow{
      padding:14px 16px;
      border-top:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.10);
      display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap;
    }
    .progressWrap{
      display:flex;align-items:center;gap:10px;flex-wrap:wrap;
      color: rgba(255,255,255,.80);
      font-weight:900;
      font-size:13px;
    }
    .progressBar{
      width:200px;height:10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      overflow:hidden;
    }
    .progressBar > i{
      display:block;height:100%;width:0%;
      background: linear-gradient(90deg, var(--red), var(--yellow), var(--blue), var(--purple));
      border-radius:999px;
    }

    .toast{
      position:fixed;left:50%;bottom:18px;transform:translateX(-50%);
      background: rgba(0,0,0,.55);
      border:1px solid rgba(255,255,255,.14);
      color: rgba(255,255,255,.92);
      padding:10px 12px;border-radius:14px;
      box-shadow: 0 16px 45px rgba(0,0,0,.45);
      font-weight:900;font-size:13px;
      display:none;
      z-index:80;
      max-width:min(92vw, 540px);
      text-align:center;
    }
    .toast.show{display:block}

    @media (max-width: 560px){
      :root{--padX: 16px;}
      h1{font-size:24px}
      .sub{font-size:14.5px}
      .panelTop{padding:12px}
      .panelBody{padding: 6px 12px 14px}
      .footerRow{padding:12px}
      .progressBar{width: min(70vw, 240px)}
      .stepHead{padding:11px}
      label.item{padding:9px}
      .txt{font-size:13.8px}
      .hint{font-size:12.2px}
    }

    @media (prefers-reduced-motion: reduce){
      *{scroll-behavior:auto !important;transition:none !important;animation:none !important}
    }

    /* =========================================================
       ‚úÖ NOVO: MODO CELULAR (ativa com body.mobileMode)
       - aumenta toque, fonte e espa√ßamento
       - esconde chips de % e progresso por etapa
       - simplifica topo e rodap√© (menos distra√ß√£o)
       ========================================================= */
    body.mobileMode .kickerBar{ width: 120px; margin: 12px 0 10px; }
    body.mobileMode h1{ font-size:22px; line-height:1.18; }
    body.mobileMode .sub{ font-size:14px; }

    body.mobileMode .panelTop{
      padding:12px;
      gap:10px;
    }
    body.mobileMode .panelBody{ padding: 6px 12px 14px; }

    /* esconde % do topo e chips das etapas (deixa s√≥ t√≠tulo) */
    body.mobileMode #chipAll{ display:none; }
    body.mobileMode .stepHead .meta{ display:none; }

    /* itens mais ‚Äútoc√°veis‚Äù */
    body.mobileMode label.item{
      padding:14px 12px;
      border-radius: 18px;
    }
    body.mobileMode input[type="checkbox"]{
      width:24px;height:24px;
      margin-top:1px;
    }
    body.mobileMode .txt{
      font-size:15px;
      line-height:1.35;
      font-weight:900;
    }

    /* dica t√©cnica mais confort√°vel */
    body.mobileMode .hint{
      font-size:13px;
      padding:10px 10px;
      border-radius:14px;
    }

    /* rodap√© mais simples */
    body.mobileMode .footerRow{
      position: sticky;
      bottom: 0;
      z-index: 40;
      backdrop-filter: blur(10px);
      background: rgba(6,10,18,.90);
    }
    body.mobileMode .progressBar{ width: min(62vw, 260px); height: 12px; }

    /* esconde bot√£o recolher no modo celular (pra evitar clique acidental) */
    body.mobileMode #collapseBtn{ display:none; }

    /* deixa bot√µes um pouco maiores */
    body.mobileMode .btn{
      padding:12px 14px;
      font-size:13.5px;
    }
    body.mobileMode .btn.small{
      padding:10px 12px;
      font-size:13px;
    }
  </style>
</head>

<body>
  <header>
    <div class="container head">
      <a class="brand" href="index.html" aria-label="Voltar para o menu geral da m√≠dia">
        <div class="logo">
          <img src="https://i.imgur.com/PlDV9NW.jpeg" alt="IEQ Nuporanga" />
        </div>
        <div class="brandTxt">
          <strong>Checklist da Transmiss√£o</strong>
          <span>IEQ Nuporanga ‚Ä¢ Equipe de M√≠dia</span>
        </div>
      </a>

      <div style="display:flex;gap:10px;flex-wrap:wrap;align-items:center">
        <a class="btn ghost" href="index.html" aria-label="Abrir menu geral da m√≠dia">üè† Menu Geral</a>
        <a class="btn" id="solutionsBtn" href="solucoes.html" aria-label="Abrir solu√ß√µes de problemas">Solu√ß√µes</a>

        <!-- ‚úÖ modo t√©cnico -->
        <button class="btn small" id="modeBtn" type="button" title="Alternar entre modo simples e modo t√©cnico">
          üß† Modo: Simples
        </button>

        <!-- ‚úÖ NOVO: modo celular -->
        <button class="btn small" id="mobileBtn" type="button" title="Aumenta bot√µes e simplifica a tela para celular">
          üì± Modo celular: OFF
        </button>

        <button class="btn" id="saveBtn" type="button">Salvar</button>
        <button class="btn danger" id="resetBtn" type="button">Limpar tudo</button>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="hero">
      <div class="kickerBar"></div>
      <h1>Checklist antes, durante e ap√≥s a live</h1>
      <p class="sub">
        Siga cada etapa com aten√ß√£o e n√£o pule verifica√ß√µes. Uma boa transmiss√£o come√ßa com organiza√ß√£o.
      </p>
    </div>

    <section class="panel" aria-label="Checklist">
      <div class="panelTop">
        <div class="left">
          <strong>Status geral</strong>
          <span id="statusText">Carregando‚Ä¶</span>
        </div>
        <div class="right" style="display:flex;gap:10px;flex-wrap:wrap;align-items:center">
          <span class="chip" id="chipSaved">N√£o salvo</span>
          <span class="chip" id="chipAll">0%</span>
        </div>
      </div>

      <div class="panelBody" id="steps"></div>

      <div class="footerRow">
        <div class="progressWrap">
          <span id="progressLabel">0/0 conclu√≠do</span>
          <div class="progressBar" aria-hidden="true"><i id="progressFill"></i></div>
        </div>
        <div style="display:flex;gap:10px;flex-wrap:wrap">
          <button class="btn primary" id="markAllBtn" type="button">Marcar tudo</button>
          <button class="btn" id="collapseBtn" type="button">Recolher etapas</button>
        </div>
      </div>
    </section>
  </main>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    const DATA = [
      {
        id: "etapa1",
        title: "ETAPA 1 ‚Äì ENERGIA E INICIALIZA√á√ÉO",
        items: [
          { text:"Ligar o disjuntor geral da sala t√©cnica", tech:"Se cair/voltar energia, espere 10s antes de religar. Evite ligar/desligar repetidamente." },
          { text:"Ligar a c√¢mera PTZ via controle remoto", tech:"Aguarde o auto-calibrar (ela costuma mexer/centralizar). Se n√£o responder, confira fonte/energia." },
          { text:"Ligar o computador da transmiss√£o", tech:"Se estiver lento, reinicie antes do culto. Evite abrir programas extras (Chrome com muitas abas pesa)." },
          { text:"Verificar se a interface de √°udio ligou corretamente", tech:"Cheque LED/power. Se n√£o aparecer no PC, troque porta USB/cabo e confira se o driver/ASIO est√° selecionado." },
          { text:"Conferir se o knob da interface est√° na posi√ß√£o ‚Äúmeio-dia‚Äù (50%)", tech:"Use isso como ponto de partida. Ajuste depois para n√£o clipar (evite LED vermelho)." },
          { text:"Aguardar todos os programas iniciarem automaticamente (n√£o abrir nada manualmente)", tech:"Isso evita abrir 2x o mesmo app e travar recursos (OBS/Studio/Drivers)." }
        ]
      },
      {
        id: "etapa2",
        title: "ETAPA 2 ‚Äì V√çDEO",
        items: [
          { text:"Verificar se o v√≠deo da c√¢mera aparece no programa OBS", tech:"Se n√£o aparecer: confira a fonte no OBS, dispositivo correto e se a c√¢mera est√° no preset certo." },
          { text:"Conferir se a imagem n√£o est√° preta ou travada", tech:"Se travar: desative/ative a fonte no OBS; se persistir, reconecte o capturador e reinicie o OBS." },
          { text:"Ajustar enquadramento para o in√≠cio do culto", tech:"Use um preset (ex: p√∫lpito central). Evite zoom digital no OBS; prefira zoom √≥ptico da PTZ." },
          { text:"Conferir se os comandos de movimento est√£o respondendo (cima, baixo, esquerda, direita e zoom)", tech:"Se s√≥ alguns comandos falham, pode ser rede/controle. Confirme IP/controle e reinicie o controller." }
        ]
      },
      {
        id: "etapa3",
        title: "ETAPA 3 ‚Äì √ÅUDIO",
        items: [
          { text:"Verificar se est√° chegando √°udio no OBS (a barra de √°udio deve estar se movimentando ao falar no microfone ou tocar instrumento)",
            tech:"Falando normal, tente manter pico por volta de -12 a -6 dB. Se ficar no vermelho, baixe ganho no pr√©/interface." },
          { text:"Conferir √°udio no fone do t√©cnico ligado ao computador", tech:"No OBS, confirme Monitoramento (se usar). No Windows, confirme o dispositivo de sa√≠da correto." },
          { text:"Verificar se n√£o existe distor√ß√µes ou excesso de ru√≠do chegando no fone t√©cnico", tech:"Se distorcer: provavelmente ganho alto no come√ßo da cadeia. Se ru√≠do: confira cabos, aterramento e USB." }
        ]
      },
      {
        id: "etapa4",
        title: "ETAPA 4 ‚Äì MESA DE SOM",
        items: [
          { text:"Conectar no Wi-Fi ‚ÄúMesa de Som‚Äù", tech:"Se n√£o conectar, esque√ßa a rede e conecte de novo. Evite ficar alternando entre Wi-Fi‚Äôs." },
          { text:"Abrir aplicativo da mesa", tech:"Deixe s√≥ esse app aberto. Evita travar e perder conex√£o." },
          { text:"Clicar em Refresh", tech:"Isso for√ßa a buscar a mesa na rede. Se n√£o aparecer, confira se o roteador da mesa est√° ligado." },
          { text:"Selecionar a mesa at√© ficar verde", tech:"Verde = achou e est√° acess√≠vel. Se ficar cinza, √© rede/roteador/senha." },
          { text:"Clicar em Connect", tech:"Se cair no meio do culto, tente reconectar sem mudar nada de IP/senha." },
          { text:"Entrar em Faders ‚Üí AUDIO LIVE", tech:"Se tiver cenas/snapshots, carregue a cena padr√£o da live (se existir) antes de ajustar." },
          { text:"Ajustar MIX da live: pedir para o louvor tocar uma m√∫sica, ajustar volumes e conferir equil√≠brio entre voz e instrumentos",
            tech:"Regra pr√°tica: voz principal sempre intelig√≠vel. Ajuste graves com cuidado (n√£o estourar no celular)." }
        ]
      },
      {
        id: "etapa5",
        title: "ETAPA 5 ‚Äì PLATAFORMAS (YOUTUBE + FACEBOOK)",
        items: [
          { text:"Entrar no YouTube Studio", tech:"Confirme se est√° na conta correta/canal certo (evita mexer na live errada)." },
          { text:"Atualizar t√≠tulo", tech:"Use padr√£o: ‚ÄúCulto ‚Äì Dia DD/MM ‚Äì IEQ Nuporanga‚Äù. Ajuda a organizar e achar depois." },
          { text:"Atualizar thumbnail", tech:"Thumbnail limpa + nome do pregador/dia. Evite polui√ß√£o visual." },
          { text:"Conferir descri√ß√£o", tech:"Inclua links essenciais (igreja, ofertas, redes sociais). Deixe um modelo pronto pra copiar/colar." },
          { text:"Alterar visibilidade para P√∫blico", tech:"Fa√ßa isso s√≥ quando tiver tudo certo (evita live p√∫blica com √°udio/imagem errados)." },
          { text:"Abrir painel da live no Facebook", tech:"Confirme se √© a live do dia. Evite reutilizar live antiga sem perceber." },
          { text:"Conferir se est√° criada corretamente (deve estar em ‚ÄúSoftware de streaming‚Äù)", tech:"Se estiver em ‚ÄòC√¢mera‚Äô, vai dar ruim. Troque pra ‚ÄòSoftware‚Äô antes de iniciar." }
        ]
      },
      {
        id: "etapa6",
        title: "ETAPA 6 ‚Äì TESTE FINAL",
        items: [
          { text:"Confirmar: tem v√≠deo", tech:"Troque entre cenas e confirme que todas t√™m v√≠deo ok (In√≠cio/Palavra/Tela Projetor/Encerrar)." },
          { text:"Confirmar: tem √°udio no OBS", tech:"Fale no microfone e veja o meter mexer. Se nada: fonte errada ou dispositivo errado." },
          { text:"Confirmar: tem √°udio no fone", tech:"Se no OBS tem √°udio, mas no fone n√£o: sa√≠da do Windows/driver/monitoramento." },
          { text:"Confirmar: mix equilibrada", tech:"Teste: voz + instrumentos + ambi√™ncia. No celular, voz precisa entender f√°cil." },
          { text:"Confirmar: internet est√°vel", tech:"Evite downloads/atualiza√ß√µes. Se puder, cabo de rede √© melhor que Wi-Fi." }
        ]
      },
      {
        id: "etapa7",
        title: "ETAPA 7 ‚Äì INICIAR TRANSMISS√ÉO",
        items: [
          { text:"No OBS clicar na cena ‚ÄúIn√≠cio‚Äù", tech:"Confirme se a cena tem √°udio e a imagem do come√ßo. Deixe tudo pronto antes de apertar ‚ÄòStart‚Äô." },
          { text:"Abrir YouTube Studio e verificar se na visualiza√ß√£o est√° aparecendo o contador de in√≠cio", tech:"Se n√£o aparecer preview, pode ser atraso. Confira se o OBS est√° ‚ÄòTransmitindo‚Äô." },
          { text:"Abrir Facebook e verificar se na visualiza√ß√£o est√° aparecendo o contador de in√≠cio", tech:"Facebook √†s vezes demora. Atualize a p√°gina uma vez, sem ficar recarregando em loop." },
          { text:"Clicar em ‚Äúiniciar a transmiss√£o‚Äù no canto inferior esquerdo (Facebook)", tech:"Algumas configura√ß√µes exigem ‚ÄòGo live‚Äô no Facebook mesmo com OBS transmitindo." }
        ]
      },
      {
        id: "etapa8",
        title: "ETAPA 8 ‚Äì DURANTE O CULTO",
        items: [
          { text:"Ap√≥s o louvor trocar para cena ‚ÄúPalavra‚Äù", tech:"Mantenha o pregador em destaque. Evite mostrar p√∫blico sem necessidade." },
          { text:"Quando mostradas imagens no projetor, trocar pra cena ‚ÄúTela Projetor‚Äù", tech:"Cheque foco/legibilidade. Se ficar estourado, ajuste exposi√ß√£o/white balance." },
          { text:"Monitorar √°udio e v√≠deo constantemente", tech:"Fique de olho em: √°udio clipando, queda de frames, travamento, rede caindo." }
        ]
      },
      {
        id: "etapa9",
        title: "ETAPA 9 ‚Äì ENCERRAMENTO",
        items: [
          { text:"Clicar na cena ‚ÄúEncerrar‚Äù", tech:"Deixe 10‚Äì20s na tela de encerramento antes de parar (evita corte seco)." },
          { text:"Confirmar encerramento no YouTube", tech:"Finalizou? Verifique se salvou/arquivou normal." },
          { text:"Confirmar encerramento no Facebook", tech:"Facebook √†s vezes mant√©m sess√£o. Confirme ‚ÄòFinalizada‚Äô." },
          { text:"Desligar c√¢mera PTZ", tech:"Use o m√©todo correto (standby/power). Evite cortar energia de uma vez." },
          { text:"Desligar o notebook pela fun√ß√£o desligar (nunca direto no disjuntor ou no bot√£o f√≠sico de ligar)",
            tech:"Isso evita corromper Windows/OBS/arquivos de grava√ß√£o e aumenta a vida √∫til." }
        ]
      }
    ];

    const KEY = "ieq_checklist_transmissao_v1";
    const KEY_MODE = "ieq_checklist_transmissao_mode_v1";
    const KEY_MOBILE = "ieq_checklist_transmissao_mobile_v1"; // ‚úÖ Novo

    const stepsEl = document.getElementById("steps");
    const statusText = document.getElementById("statusText");
    const progressLabel = document.getElementById("progressLabel");
    const progressFill = document.getElementById("progressFill");
    const chipSaved = document.getElementById("chipSaved");
    const chipAll = document.getElementById("chipAll");
    const toast = document.getElementById("toast");

    const saveBtn = document.getElementById("saveBtn");
    const resetBtn = document.getElementById("resetBtn");
    const markAllBtn = document.getElementById("markAllBtn");
    const collapseBtn = document.getElementById("collapseBtn");
    const modeBtn = document.getElementById("modeBtn");
    const mobileBtn = document.getElementById("mobileBtn"); // ‚úÖ Novo

    let state = { checked: {}, updatedAt: null };
    let collapsed = false;
    let dirty = false;

    let mode = "simple";   // simple | tech
    let mobileMode = false; // ‚úÖ Novo

    function showToast(msg){
      toast.textContent = msg;
      toast.classList.add("show");
      window.clearTimeout(showToast._t);
      showToast._t = window.setTimeout(()=>toast.classList.remove("show"), 2200);
    }

    function setMobileMode(on){
      mobileMode = !!on;
      document.body.classList.toggle("mobileMode", mobileMode);
      mobileBtn.textContent = mobileMode ? "üì± Modo celular: ON" : "üì± Modo celular: OFF";
      mobileBtn.classList.toggle("primary", mobileMode);
      try{ localStorage.setItem(KEY_MOBILE, mobileMode ? "1" : "0"); }catch(e){}
    }

    function load(){
      try{
        const raw = localStorage.getItem(KEY);
        if(raw){
          const parsed = JSON.parse(raw);
          if(parsed && typeof parsed === "object") state = parsed;
        }
      }catch(e){}

      try{
        const m = localStorage.getItem(KEY_MODE);
        if(m === "tech" || m === "simple") mode = m;
      }catch(e){}
      updateModeButton();

      // ‚úÖ carrega modo celular
      try{
        const mm = localStorage.getItem(KEY_MOBILE);
        if(mm === "1") setMobileMode(true);
      }catch(e){}
    }

    function save(){
      state.updatedAt = new Date().toISOString();
      localStorage.setItem(KEY, JSON.stringify(state));
      dirty = false;
      updateSavedChip(true);
      showToast("Checklist salvo!");
    }

    function resetAll(){
      state = { checked:{}, updatedAt:null };
      dirty = true;
      render();
      updateSavedChip(false);
      showToast("Checklist limpo.");
    }

    function updateSavedChip(saved){
      chipSaved.textContent = saved ? "Salvo" : (dirty ? "N√£o salvo" : "N√£o salvo");
      chipSaved.classList.toggle("ok", saved && !dirty);
      chipSaved.classList.toggle("active", false);
    }

    function stepProgress(step){
      const total = step.items.length;
      let done = 0;
      for(let i=0;i<total;i++){
        const k = `${step.id}:${i}`;
        if(state.checked[k]) done++;
      }
      return {done,total};
    }

    function overallProgress(){
      let total = 0;
      let done = 0;
      for(const step of DATA){
        total += step.items.length;
        for(let i=0;i<step.items.length;i++){
          const k = `${step.id}:${i}`;
          if(state.checked[k]) done++;
        }
      }
      return {done,total};
    }

    function setChecked(key, val){
      state.checked[key] = !!val;
      dirty = true;
      updateSavedChip(false);
      updateUIOnly();
    }

    function toggleCollapsed(){
      collapsed = !collapsed;
      collapseBtn.textContent = collapsed ? "Expandir etapas" : "Recolher etapas";
      document.querySelectorAll(".stepBody").forEach(el=>{
        el.style.display = collapsed ? "none" : "block";
      });
    }

    function updateModeButton(){
      modeBtn.textContent = mode === "tech" ? "üß† Modo: T√©cnico" : "üß† Modo: Simples";
      modeBtn.classList.toggle("primary", mode === "tech");
    }
    function toggleMode(){
      mode = (mode === "tech") ? "simple" : "tech";
      try{ localStorage.setItem(KEY_MODE, mode); }catch(e){}
      updateModeButton();
      render();
      showToast(mode === "tech" ? "Modo t√©cnico ativado" : "Modo simples ativado");
    }

    function render(){
      stepsEl.innerHTML = "";

      for(const step of DATA){
        const {done,total} = stepProgress(step);
        const pct = total ? Math.round((done/total)*100) : 0;

        const wrap = document.createElement("div");
        wrap.className = "step";
        wrap.setAttribute("data-step", step.id);

        const head = document.createElement("div");
        head.className = "stepHead";
        head.tabIndex = 0;
        head.setAttribute("role","button");
        head.setAttribute("aria-label", step.title);

        const h2 = document.createElement("h2");
        h2.textContent = step.title;

        const meta = document.createElement("div");
        meta.className = "meta";

        const chip1 = document.createElement("span");
        chip1.className = "chip " + (pct === 100 ? "ok" : "");
        chip1.textContent = `${done}/${total}`;
        chip1.setAttribute("data-step-id", step.id);
        chip1.setAttribute("data-step-chip", "count");

        const chip2 = document.createElement("span");
        chip2.className = "chip " + (pct === 100 ? "ok" : "");
        chip2.textContent = `${pct}%`;
        chip2.setAttribute("data-step-id", step.id);
        chip2.setAttribute("data-step-chip", "pct");

        meta.appendChild(chip1);
        meta.appendChild(chip2);

        head.appendChild(h2);
        head.appendChild(meta);

        const body = document.createElement("div");
        body.className = "stepBody";
        body.style.display = collapsed ? "none" : "block";

        const items = document.createElement("div");
        items.className = "items";

        step.items.forEach((item, idx)=>{
          const k = `${step.id}:${idx}`;
          const text = (item && typeof item === "object") ? item.text : String(item);
          const tech = (item && typeof item === "object") ? item.tech : "";

          const lab = document.createElement("label");
          lab.className = "item";

          const cb = document.createElement("input");
          cb.type = "checkbox";
          cb.checked = !!state.checked[k];
          cb.addEventListener("click", (e)=>e.stopPropagation());
          cb.addEventListener("change", ()=>setChecked(k, cb.checked));

          const wrapTxt = document.createElement("div");
          wrapTxt.className = "txtWrap";

          const t = document.createElement("div");
          t.className = "txt";
          t.textContent = text;

          wrapTxt.appendChild(t);

          if(mode === "tech" && tech){
            const h = document.createElement("div");
            h.className = "hint";
            h.textContent = tech;
            wrapTxt.appendChild(h);
          }

          lab.appendChild(cb);
          lab.appendChild(wrapTxt);
          items.appendChild(lab);
        });

        body.appendChild(items);

        function toggleStepBody(){
          const isHidden = body.style.display === "none";
          body.style.display = isHidden ? "block" : "none";
        }
        head.addEventListener("click", toggleStepBody);
        head.addEventListener("keydown", (e)=>{
          if(e.key === "Enter" || e.key === " "){
            e.preventDefault();
            toggleStepBody();
          }
        });

        wrap.appendChild(head);
        wrap.appendChild(body);
        stepsEl.appendChild(wrap);
      }

      updateUIOnly();
    }

    function updateUIOnly(){
      const {done,total} = overallProgress();
      const pct = total ? Math.round((done/total)*100) : 0;

      statusText.textContent = `${done} de ${total} itens conclu√≠dos`;
      progressLabel.textContent = `${done}/${total} conclu√≠do`;
      progressFill.style.width = `${pct}%`;
      chipAll.textContent = `${pct}%`;

      for(const step of DATA){
        const {done: sd, total: st} = stepProgress(step);
        const sp = st ? Math.round((sd/st)*100) : 0;

        const chipCount = document.querySelector(`[data-step-id="${step.id}"][data-step-chip="count"]`);
        const chipPct   = document.querySelector(`[data-step-id="${step.id}"][data-step-chip="pct"]`);

        if(chipCount){
          chipCount.textContent = `${sd}/${st}`;
          chipCount.classList.toggle("ok", sp === 100);
        }
        if(chipPct){
          chipPct.textContent = `${sp}%`;
          chipPct.classList.toggle("ok", sp === 100);
        }
      }

      if(dirty){
        chipSaved.textContent = "N√£o salvo";
        chipSaved.classList.remove("ok");
      }else{
        chipSaved.textContent = state.updatedAt ? "Salvo" : "N√£o salvo";
        chipSaved.classList.toggle("ok", !!state.updatedAt);
      }
    }

    // Ctrl+S salva
    window.addEventListener("keydown", (e)=>{
      if((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === "s"){
        e.preventDefault();
        save();
      }
    });

    // atalho M alterna modo t√©cnico/simples
    window.addEventListener("keydown", (e)=>{
      if(e.key.toLowerCase() === "m" && !e.ctrlKey && !e.metaKey && !e.altKey){
        const tag = (document.activeElement && document.activeElement.tagName) ? document.activeElement.tagName.toLowerCase() : "";
        if(tag !== "input" && tag !== "textarea") toggleMode();
      }
    });

    // ‚úÖ Novo: atalho C alterna modo celular
    window.addEventListener("keydown", (e)=>{
      if(e.key.toLowerCase() === "c" && !e.ctrlKey && !e.metaKey && !e.altKey){
        const tag = (document.activeElement && document.activeElement.tagName) ? document.activeElement.tagName.toLowerCase() : "";
        if(tag !== "input" && tag !== "textarea") setMobileMode(!mobileMode);
      }
    });

    saveBtn.addEventListener("click", save);
    resetBtn.addEventListener("click", ()=>{
      if(confirm("Tem certeza que deseja limpar todo o checklist?")){
        resetAll();
      }
    });

    markAllBtn.addEventListener("click", ()=>{
      for(const step of DATA){
        for(let i=0;i<step.items.length;i++){
          state.checked[`${step.id}:${i}`] = true;
        }
      }
      dirty = true;
      updateSavedChip(false);
      render();
      showToast("Tudo marcado. Salve para gravar.");
    });

    collapseBtn.addEventListener("click", toggleCollapsed);
    modeBtn.addEventListener("click", toggleMode);

    // ‚úÖ Novo: bot√£o modo celular
    mobileBtn.addEventListener("click", ()=>setMobileMode(!mobileMode));

    load();
    render();
  </script>
</body>
</html>

