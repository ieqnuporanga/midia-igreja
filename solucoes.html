<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Solu√ß√µes de Problemas | IEQ Nuporanga</title>
  <meta name="description" content="Guia de solu√ß√µes para problemas na transmiss√£o ao vivo (volunt√°rios). IEQ Nuporanga." />
  <meta name="theme-color" content="#060A12" />
  <meta name="referrer" content="strict-origin-when-cross-origin" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900;950&display=swap" rel="stylesheet">

  <style>
.stage,
.problem,
.solution,
.search,
.headerMenu,
.modal,
.pill,
.chip{
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
}

:root{
  --bg0:#070A12;
  --bg1:#0B1220;

  --card: rgba(255,255,255,.08);
  --card2: rgba(255,255,255,.10);
  --line: rgba(255,255,255,.10);

  --text: rgba(255,255,255,.94);
  --muted: rgba(255,255,255,.76);
  --muted2: rgba(255,255,255,.66);

  --accent1:#7C3AED;
  --accent2:#06B6D4;
  --accent3:#22C55E;
  --accent4:#F59E0B;
  --danger:#EF4444;
  --ok:#22C55E;

  --shadow: 0 18px 55px rgba(0,0,0,.40);
  --shadow2: 0 10px 26px rgba(0,0,0,.30);

  --max: 1040px;
  --r28: 28px;
  --r22: 22px;
  --r18: 18px;

  /* MAIS ‚ÄúRESPIRO‚Äù NO MOBILE */
  --padX: 18px;
}

*{box-sizing:border-box}
html{
  height:100%;
  background:var(--bg0);
  overscroll-behavior:none;
}

body{
  margin:0;
  min-height:100%;
  font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color: var(--text);
  line-height:1.6;
  overflow-x:hidden;
  text-rendering: optimizeLegibility;
  position:relative;
  background: linear-gradient(180deg, var(--bg1) 0%, var(--bg0) 100%);
}

/* ===== BORR√ÉO / GLOW NO FUNDO ===== */
body::before{
  content:"";
  position: fixed;
  inset: -22%;
  z-index: -1;
  pointer-events: none;
  background:
    radial-gradient(900px 700px at 18% 12%, rgba(124,58,237,.20), transparent 70%),
    radial-gradient(900px 700px at 82% 16%, rgba(6,182,212,.16), transparent 72%),
    radial-gradient(900px 700px at 55% 88%, rgba(34,197,94,.11), transparent 74%),
    radial-gradient(1100px 900px at 50% 50%, rgba(245,158,11,.06), transparent 78%);
  filter: blur(58px);
  opacity: .95;
  transform: translateZ(0);
}

a{color:inherit;text-decoration:none}
button{font-family:inherit}

.container{
  max-width:var(--max);
  margin:0 auto;
  padding:
    0 calc(var(--padX) + env(safe-area-inset-right))
    0 calc(var(--padX) + env(safe-area-inset-left));
}

:focus-visible{
  outline: 2px solid rgba(6,182,212,.65);
  outline-offset: 2px;
  border-radius: 14px;
}

.hidden{display:none !important}

@media (max-width: 560px){
  :root{ --padX: 16px; } /* mais centralizado no celular */
}

@media (prefers-reduced-motion: reduce){
  *{scroll-behavior:auto !important;transition:none !important;animation:none !important}
}

/* ===== HEADER ===== */
header{
  position:sticky;top:0;z-index:50;
  background: rgba(7,10,18,.70);
  backdrop-filter: blur(14px);
  border-bottom:1px solid rgba(255,255,255,.10);
  transition: background .25s ease, box-shadow .25s ease;
}
header.compact{
  background: rgba(7,10,18,.85);
  box-shadow: 0 10px 25px rgba(0,0,0,.30);
}
.head{
  display:flex;align-items:center;justify-content:space-between;
  gap:12px;
  padding:12px 0;
  flex-wrap:wrap;
  transition: padding .25s ease;
}
header.compact .head{padding:6px 0}

.brand{display:flex;align-items:center;gap:12px;min-width:0}
.logo{
  width:44px;height:44px;border-radius:16px;overflow:hidden;flex:0 0 auto;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  box-shadow: 0 10px 18px rgba(0,0,0,.22);
  display:grid;place-items:center;
  transition: width .25s ease, height .25s ease, border-radius .25s ease;
}
header.compact .logo{width:36px;height:36px;border-radius:12px}
.logo img{width:100%;height:100%;object-fit:cover}

.brandTxt{min-width:0}
.brandTxt strong{
  display:block;font-weight:950;letter-spacing:-.4px;
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
  max-width: 66vw;line-height:1.05;
}
.brandTxt span{
  display:block;font-size:12.5px;font-weight:900;
  color: rgba(255,255,255,.70);
  white-space:nowrap;overflow:hidden;text-overflow:ellipsis;
  max-width: 66vw;margin-top:3px;
}
header.compact .brandTxt strong{font-size:15px}
header.compact .brandTxt span{font-size:11px}

.btnRow{display:flex;gap:10px;flex-wrap:wrap;align-items:center}

/* ===== BUTTONS ===== */
.btn{
  display:inline-flex;align-items:center;justify-content:center;gap:10px;
  font-size:13.5px;font-weight:950;
  padding:10px 12px;border-radius:999px;
  border:1px solid rgba(255,255,255,.16);
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.95);
  cursor:pointer;user-select:none;
  transition: transform .12s ease, background .12s ease, border-color .12s ease, box-shadow .12s ease, opacity .12s ease;
  white-space:nowrap;
}
.btn:hover{
  transform:translateY(-1px);
  background: rgba(255,255,255,.10);
  border-color: rgba(255,255,255,.22);
  box-shadow: 0 10px 18px rgba(0,0,0,.22);
}
.btn:active{transform:translateY(0)}
.btn.primary{
  border-color: rgba(124,58,237,.45);
  background: linear-gradient(180deg, rgba(124,58,237,.32), rgba(124,58,237,.18));
  box-shadow: 0 10px 22px rgba(124,58,237,.10);
}
.btn.primary:hover{
  border-color: rgba(124,58,237,.62);
  background: linear-gradient(180deg, rgba(124,58,237,.42), rgba(124,58,237,.20));
}
.btn.ghost{background: rgba(255,255,255,.05)}
.btn.small{padding:8px 10px;font-size:13px}
.btn.danger{
  border-color: rgba(239,68,68,.40);
  background: rgba(239,68,68,.14);
}
.btn.danger:hover{
  border-color: rgba(239,68,68,.58);
  background: rgba(239,68,68,.18);
}
.btn.ok{
  border-color: rgba(34,197,94,.40);
  background: rgba(34,197,94,.14);
}
.btn.ok:hover{
  border-color: rgba(34,197,94,.58);
  background: rgba(34,197,94,.18);
}

/* ===== MENU MOBILE (‚ãÆ) ===== */
.menuBtn{
  display:none;
  width:42px;height:42px;
  border-radius:16px;
  border:1px solid rgba(255,255,255,.16);
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.95);
  font-weight:950;
  font-size:22px;
  line-height:1;
  cursor:pointer;
  user-select:none;
  transition: transform .12s ease, background .12s ease, border-color .12s ease, box-shadow .12s ease, opacity .12s ease;
}
.menuBtn:hover{
  transform:translateY(-1px);
  background: rgba(255,255,255,.10);
  border-color: rgba(255,255,255,.22);
  box-shadow: 0 10px 18px rgba(0,0,0,.22);
}
.menuBtn:active{transform:translateY(0)}

.menuOverlay{
  position:fixed; inset:0;
  background: rgba(2,6,23,.55);
  backdrop-filter: blur(6px);
  display:none;
  z-index:120;
}
.menuOverlay.show{display:block}

.headerMenu{
  position:fixed;
  top:64px;
  right:18px;
  width:min(340px, calc(100vw - 28px));
  border:1px solid rgba(255,255,255,.14);
  background: rgba(11,18,32,.96);
  border-radius: 22px;
  box-shadow: 0 22px 90px rgba(0,0,0,.55);
  padding:12px;
  display:none;
  z-index:130;
}
.headerMenu.show{display:block}

.headerMenu .menuTitle{
  font-weight:950;
  letter-spacing:-.2px;
  font-size:13px;
  color: rgba(255,255,255,.90);
  display:flex;align-items:center;justify-content:space-between;gap:10px;
  padding:6px 6px 10px;
  border-bottom:1px solid rgba(255,255,255,.10);
  margin-bottom:10px;
}
.headerMenu .menuClose{
  width:38px;height:38px;border-radius:14px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.92);
  font-weight:950;
  cursor:pointer;
}
.headerMenu .menuGrid{
  display:flex;
  flex-direction:column;
  gap:10px;
}
.headerMenu .menuGrid .btn{
  width:100%;
  justify-content:flex-start;
}

/* no mobile: some a fileira de bot√µes e aparece o ‚ãÆ */
@media (max-width: 520px){
  .btnRow{display:none;}
  .menuBtn{display:inline-grid;place-items:center;margin-right:2px;}
  .head{
    padding:8px 0;
    flex-wrap:nowrap;
  }
  .logo{ width:34px; height:34px; border-radius:12px; }
  .brandTxt strong{ font-size:14px; }
  .brandTxt span{ font-size:11px; }
}

main{padding: 14px 0 24px}

/* ===== HERO ===== */
.kickerBar{
  height:10px;border-radius:999px;
  background: linear-gradient(90deg, var(--accent1), var(--accent2), var(--accent3), var(--accent4));
  width: 168px;
  margin: 14px 0 12px;
  box-shadow: 0 10px 28px rgba(124,58,237,.10);
}
.hero{
  padding:18px 0 10px;
  display:flex;
  flex-direction:column;
  align-items:flex-start;
}
h1{
  margin:0 0 8px;
  font-weight:950;
  letter-spacing:-1px;
  line-height:1.12;
  font-size: clamp(22px, 4.8vw, 32px);
}
.sub{
  margin:0;
  color: var(--muted);
  font-weight:800;
  font-size:14.8px;
}

/* tools row */
.toolsRow{
  margin-top:14px;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
  justify-content:space-between;
}
.search{
  flex: 1 1 420px;
  display:flex;
  gap:10px;
  align-items:center;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(0,0,0,.20);
  border-radius: 20px;
  padding:10px 12px;
  box-shadow: var(--shadow2);
}
.search .icon{
  width:34px;height:34px;border-radius:12px;
  display:grid;place-items:center;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.92);
  flex:0 0 auto;
}
.search input{
  width:100%;
  border:0;
  outline:0;
  background: transparent;
  color: rgba(255,255,255,.94);
  font-weight:900;
  font-size:14.5px;
}
.search input::placeholder{color: rgba(255,255,255,.55);font-weight:800}
.search .clearBtn{
  flex:0 0 auto;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.92);
  font-weight:950;
  border-radius: 999px;
  padding:8px 10px;
  cursor:pointer;
}

/* stats */
.stats{
  margin-top:12px;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
}
.pill{
  display:inline-flex;align-items:center;gap:10px;
  padding:10px 12px;border-radius:999px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(0,0,0,.18);
  font-weight:950;
  color: rgba(255,255,255,.92);
}
.pill small{font-weight:900;color: rgba(255,255,255,.74)}
.pill .num{
  min-width: 34px;height: 26px;
  display:inline-grid;place-items:center;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  font-weight:950;
}

.stage{
  border:1px solid rgba(255,255,255,.12);
  border-radius: 24px;
  overflow:hidden;
  background: rgba(255,255,255,.06);
  box-shadow: var(--shadow2);
  margin: 14px 0 12px;
}
.stageHead{
  padding: 14px 14px;
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap:12px;
  border-bottom:1px solid rgba(255,255,255,.10);
  background: rgba(0,0,0,.10);
}
.stageHead .left{min-width:0;}
.stageHead .title{
  margin:0;
  font-weight:950;
  letter-spacing:-.4px;
  font-size:16px;
  color: rgba(255,255,255,.95);
  text-transform: uppercase;
}
.stageHead .hint{
  margin-top:6px;
  font-size:12.5px;
  font-weight:850;
  color: rgba(255,255,255,.70);
}
.chip{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:8px 10px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.92);
  font-weight:950;
  font-size:12.5px;
  white-space:nowrap;
}
.problemList{padding: 12px; display:flex; flex-direction:column; gap:10px;}

.problem{
  border:1px solid rgba(255,255,255,.12);
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(0,0,0,.16));
  border-radius: 22px;
  overflow:hidden;
}
.problemTop{
  padding:16px 14px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  cursor:pointer;
}
.problemTop:hover{background: rgba(255,255,255,.04)}
.problemTop .rowLeft{
  display:flex;
  align-items:center;
  gap:10px;
  min-width:0;
}
.q{
  margin:0;
  font-weight:950;
  letter-spacing:-.2px;
  color: rgba(255,255,255,.96);
  font-size:15px;
  line-height:1.25;
  min-width:0;
}
.q .qIcon{color:#F43F5E;margin-right:6px;}
.problemTop .rowRight{
  display:flex;
  align-items:center;
  gap:10px;
  flex:0 0 auto;
}

/* ===== LAYOUT: ‚ÄúPoss√≠veis solu√ß√µes: X‚Äù + seta redonda ===== */
.miniNav{
  display:flex;
  align-items:center;
  gap:10px;
}
.miniLabel{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  height:28px;
  padding:0 9px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.16);
  box-shadow: 0 8px 14px rgba(0,0,0,.16);
  font-weight:950;
  letter-spacing:-.2px;
  color: rgba(255,255,255,.92);
  line-height:1;
  white-space:nowrap;
  font-size:11.5px;
}

.miniLabel .muted{opacity:.78;font-weight:950}
.miniLabel .num{opacity:.95}

.miniArrow{
  width:32px; height:32px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.12);
  box-shadow: 0 8px 14px rgba(0,0,0,.16);
  display:grid;place-items:center;
  color: rgba(255,255,255,.92);
  font-weight:950;
  font-size:18px;
  line-height:1;
  transition: transform .16s ease, background .12s ease, border-color .12s ease;
}
.problemTop:hover .miniArrow{
  background: rgba(255,255,255,.06);
  border-color: rgba(255,255,255,.18);
}
.problem .miniArrow{transform: rotate(0deg)}
.problem.open .miniArrow{transform: rotate(90deg)}

.problemBody{
  display:none;
  padding: 0 14px 14px;
  background: rgba(255,255,255,.03);
}
.problem.open .problemBody{display:block}

.solutionsHeader{
  margin-top:10px;
  display:flex;
  align-items:baseline;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
}
.solutionsHeader .bulletTitle{
  font-size:13px;
  font-weight:950;
  color: rgba(255,255,255,.92);
  letter-spacing:-.1px;
  line-height:1.2;
}
.solutionsHeader .right{
  font-size:12px;
  color: rgba(255,255,255,.72);
  font-weight:900;
  line-height:1.2;
}

.solution{
  margin-top:10px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.16);
  border-radius: 18px;
  overflow:hidden;
}
.solutionTop{
  padding:12px 12px;
  display:flex;align-items:center;justify-content:space-between;gap:12px;
  cursor:pointer;
}
.solutionTop:hover{background: rgba(255,255,255,.04)}
.solutionTop .left{display:flex;align-items:flex-start;gap:10px;min-width:0}
.dot{
  flex:0 0 auto;
  width:18px;height:18px;
  display:grid;place-items:center;
  margin-top:2px;
  color: rgba(255,255,255,.86);
  font-weight:950;
  font-size:16px;
  line-height:1;
  opacity:.92;
}
.solText{
  font-size:14.5px;
  font-weight:850;
  color: rgba(255,255,255,.92);
  line-height:1.45;
  min-width:0;
}
.solChev{
  width:36px;height:36px;border-radius:14px;
  display:grid;place-items:center;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.92);
  transition: transform .16s ease;
  flex:0 0 auto;
  font-weight: 950;
  font-size: 20px;
  line-height: 1;
}
.solution .solChev{transform: rotate(0deg)}
.solution.open .solChev{transform: rotate(90deg)}

.solutionBody{
  display:none;
  padding: 0 12px 12px;
  background: rgba(255,255,255,.03);
}
.solution.open .solutionBody{display:block}

/* tira seta e ‚Äúclic√°vel‚Äù quando N√ÉO tem complemento */
.solution.noSteps .solChev{display:none !important;}
.solution.noSteps .solutionTop{cursor:default;}
.solution.noSteps .solutionTop:hover{background: transparent;}

.steps{
  margin:10px 0 0;
  padding-left: 0;
  list-style:none;
  display:flex;flex-direction:column;gap:8px;
}
.steps li{
  display:flex;gap:10px;align-items:flex-start;
  color: rgba(255,255,255,.88);
  font-size:14.2px;
  font-weight:800;
  line-height:1.55;
}
.steps li .arr{
  flex:0 0 auto;
  width:22px;height:22px;border-radius:8px;
  display:grid;place-items:center;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.92);
  margin-top:2px;
}

.actions{margin-top:12px;display:flex;gap:8px;flex-wrap:wrap;align-items:center}
.smallBtn{
  display:inline-flex;align-items:center;justify-content:center;gap:8px;
  font-size:13.5px;font-weight:950;
  padding:10px 12px;border-radius:999px;
  border:1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.08);
  color: rgba(255,255,255,.94);
  cursor:pointer;
  transition: transform .12s ease, background .12s ease, border-color .12s ease, opacity .12s ease, box-shadow .12s ease;
  white-space:nowrap;
  user-select:none;
}
.smallBtn:hover{transform:translateY(-1px);background: rgba(255,255,255,.12);border-color: rgba(255,255,255,.24);box-shadow: 0 10px 18px rgba(0,0,0,.20)}
.smallBtn:disabled{opacity:.55;cursor:not-allowed;transform:none}
.smallBtn.ok{border-color: rgba(34,197,94,.35); background: rgba(34,197,94,.12)}
.smallBtn.danger{border-color: rgba(239,68,68,.35); background: rgba(239,68,68,.12)}
.smallBtn.ghost{background: rgba(255,255,255,.06)}

/* ===== BOT√ÉO ‚ÄúVER V√çDEO‚Äù (placeholder quando sem link) ===== */
.smallBtn.video{
  border-color: rgba(6,182,212,.35);
  background: rgba(6,182,212,.10);
}
.smallBtn.video:hover{
  border-color: rgba(6,182,212,.55);
  background: rgba(6,182,212,.14);
}
.smallBtn.disabled{
  opacity:.55;
  cursor:not-allowed;
  pointer-events:none;
  box-shadow:none !important;
  transform:none !important;
}

mark{
  background: rgba(245,158,11,.22);
  border: 1px solid rgba(245,158,11,.22);
  color: rgba(255,255,255,.94);
  border-radius: 8px;
  padding: 0 4px;
  font-weight: 950;
}

footer{
  margin-top:18px;
  padding:18px 0 24px;
  border-top:1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.10);
}
.footGrid{
  display:flex;justify-content:space-between;gap:12px;flex-wrap:wrap;
  color: rgba(255,255,255,.74);
  font-size:12px;
  font-weight:900;
}

/* ===== MODAL DE V√çDEO (NOVO) ===== */
.videoBackdrop{
  position:fixed; inset:0;
  background: rgba(2,6,23,.72);
  display:none;
  z-index:220;
  padding:18px;
}
.videoBackdrop.show{
  display:grid;
  place-items:center;
}
.videoModal{
  width:min(860px, 100%);
  border-radius: 24px;
  border:1px solid rgba(255,255,255,.14);
  background: #0B1220;
  box-shadow: 0 22px 90px rgba(0,0,0,.55);
  overflow:hidden;
}
.videoHead{
  padding:12px 12px;
  display:flex;align-items:center;justify-content:space-between;gap:10px;
  border-bottom:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.05);
}
.videoTitle{
  font-weight:950;
  letter-spacing:-.2px;
  font-size:13px;
  color: rgba(255,255,255,.92);
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  max-width: 70%;
}
.videoClose{
  width:40px;height:40px;border-radius:14px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: rgba(255,255,255,.92);
  font-weight:950;
  cursor:pointer;
}
.videoBody{
  padding:12px;
}
.videoFrameWrap{
  border:1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.20);
  border-radius: 18px;
  overflow:hidden;
  box-shadow: var(--shadow2);
}
/* aspect ratio 16:9 */
.videoFrame{
  width:100%;
  aspect-ratio: 16/9;
  border:0;
  display:block;
}

/* mobile mode */
@media (max-width: 520px){
  .btn,.smallBtn{padding:10px 12px}
  .search{flex: 1 1 100%;}
}

/* mobile mode */
body.mobileMode .kickerBar{ width: 120px; margin: 12px 0 10px; }
body.mobileMode h1{ font-size:23px; line-height:1.18; }
body.mobileMode .sub{ font-size:15px; line-height:1.55; }
body.mobileMode .search input{ font-size:15px; }
body.mobileMode .q{ font-size:16px; line-height:1.25; }
body.mobileMode .problemTop{ padding:16px 14px; }
body.mobileMode .miniLabel{ height:40px; }
body.mobileMode .miniArrow{ width:44px; height:44px; }
body.mobileMode .solText{ font-size:15.2px; line-height:1.45; }
body.mobileMode .solutionTop{ padding:14px 12px; }
body.mobileMode .steps li{ font-size:14.6px; line-height:1.6; }
  </style>
</head>

<body>
  <header>
    <div class="container head">
      <a class="brand" href="index.html" aria-label="Voltar para o menu geral da m√≠dia">
        <div class="logo">
          <img src="https://i.imgur.com/PlDV9NW.jpeg" alt="IEQ Nuporanga" />
        </div>
        <div class="brandTxt">
          <strong>Solu√ß√µes de Problemas</strong>
          <span>Transmiss√£o ‚Ä¢ Manual Vivo</span>
        </div>
      </a>

      <!-- Desktop -->
      <div class="btnRow" id="btnRowDesktop">
        <a class="btn ghost" href="index.html" title="Ir para o menu geral da m√≠dia">üè† In√≠cio</a>

        <a class="btn ghost" href="checklist.html" title="Abrir o CheckList">üìã CheckList</a>

        <button class="btn small" id="btnMobile" type="button" title="Aumenta bot√µes e melhora leitura no celular">
          üì± Modo celular: OFF
        </button>

        <button class="btn danger" id="btnEmergency" type="button" title="Ligar emerg√™ncia">üö® Emerg√™ncia</button>
        <a class="btn ok" id="btnWhats" href="#" target="_blank" rel="noopener" title="Chamar t√©cnico no WhatsApp">üí¨ Chamar t√©cnico</a>
      </div>

      <!-- Mobile: ‚ãÆ -->
      <button class="menuBtn" id="menuBtn" type="button" aria-label="Abrir menu" aria-expanded="false">‚ãÆ</button>
    </div>

    <!-- Overlay + Menu flutuante -->
    <div class="menuOverlay" id="menuOverlay" aria-hidden="true"></div>

    <nav class="headerMenu" id="headerMenu" aria-label="Menu do topo">
      <div class="menuTitle">
        <span>Op√ß√µes</span>
        <button class="menuClose" id="menuClose" type="button" aria-label="Fechar menu">‚úï</button>
      </div>

      <div class="menuGrid">
        <a class="btn ghost" href="index.html">üè† In√≠cio</a>

        <a class="btn ghost" href="checklist.html">üìã CheckList</a>

        <button class="btn small" id="btnMobile_m" type="button">üì± Modo celular: OFF</button>
        <button class="btn danger" id="btnEmergency_m" type="button">üö® Emerg√™ncia</button>
        <a class="btn ok" id="btnWhats_m" href="#" target="_blank" rel="noopener">üí¨ Chamar t√©cnico</a>
      </div>
    </nav>
  </header>

  <main class="container">
    <div class="hero">
      <div class="kickerBar" aria-hidden="true"></div>

      <h1>Manual Vivo ‚Äî Solu√ß√µes r√°pidas</h1>
      <p class="sub">
        Sempre mantenha a calma e siga as orienta√ß√µes por etapa.<br>
        <b>Importante:</b> em cada problema, as a√ß√µes abaixo s√£o <b>poss√≠veis solu√ß√µes</b>. Tente <b>uma por vez</b>.
      </p>

      <div class="toolsRow">
        <div class="search" role="search" aria-label="Pesquisar problemas">
          <div class="icon" aria-hidden="true">üîé</div>
          <input id="searchInput" type="text" placeholder="Pesquisar: '√°udio', 'mesa', 'travando', 'chave'..." autocomplete="off" />
          <button class="clearBtn" id="btnClearSearch" type="button" title="Limpar busca">Limpar</button>
        </div>
      </div>

      <div class="stats">
        <div class="pill">
          üîé Resultados: <span class="num" id="resultCount">0</span>
          <small>conforme busca</small>
        </div>
      </div>
    </div>

    <div id="app"></div>
  </main>

  <footer>
    <div class="container footGrid">
      <div>¬© <span id="year"></span> ‚Ä¢ IEQ Nuporanga</div>
      <div>Se n√£o resolver: use ‚Äúüö® Emerg√™ncia‚Äù ou ‚Äúüí¨ Chamar t√©cnico‚Äù.</div>
    </div>
  </footer>

  <!-- MODAL EMERG√äNCIA -->
  <div class="modalBackdrop" id="modalBackdrop" aria-hidden="true" style="
    position:fixed; inset:0;
    background: rgba(2,6,23,.70);
    display:none;
    z-index:200;
    padding:18px;">
    <div class="modal" role="dialog" aria-modal="true" aria-label="Emerg√™ncia" style="
      width:min(680px, 100%);
      margin: auto;
      border-radius: 24px;
      border:1px solid rgba(255,255,255,.14);
      background: #0B1220;
      box-shadow: 0 22px 90px rgba(0,0,0,.55);
      overflow:hidden;">
      <div class="modalHead" style="
        padding:12px 12px;
        display:flex;align-items:center;justify-content:space-between;gap:10px;
        border-bottom:1px solid rgba(255,255,255,.12);
        background: rgba(255,255,255,.05);">
        <strong>üö® Emerg√™ncia</strong>
        <button class="btn ghost" id="modalClose" type="button">‚úï</button>
      </div>
      <div class="modalBody" style="padding:12px">
        <p style="margin:0 0 10px;color: rgba(255,255,255,.86);font-size:13px;font-weight:850;line-height:1.55">
          Se ningu√©m conseguir solucionar, use as op√ß√µes abaixo:
        </p>
        <div class="box" style="
          border:1px solid rgba(255,255,255,.14);
          background: rgba(255,255,255,.06);
          border-radius: 18px;
          padding:12px;">
          <p style="margin:0;color: rgba(255,255,255,.86);font-size:13px;font-weight:850;line-height:1.55">
            <b style="color: rgba(255,255,255,.92)">Op√ß√£o 1:</b> Chamar o t√©cnico no WhatsApp (recomendado).<br>
            <b style="color: rgba(255,255,255,.92)">Op√ß√£o 2:</b> Fazer liga√ß√£o (se necess√°rio).
          </p>
        </div>
      </div>
      <div class="modalFoot" style="
        padding:12px;
        border-top:1px solid rgba(255,255,255,.12);
        background: rgba(255,255,255,.05);
        display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end;">
        <a class="btn ok" id="modalWhats" href="#" target="_blank" rel="noopener">üí¨ WhatsApp do t√©cnico</a>
        <a class="btn danger" id="modalCall" href="tel:+5516994241388">üìû Ligar agora</a>
        <button class="btn ghost" id="modalOk" type="button">Entendi</button>
      </div>
    </div>
  </div>

  <!-- MODAL V√çDEO (NOVO) -->
  <div class="videoBackdrop" id="videoBackdrop" aria-hidden="true">
    <div class="videoModal" role="dialog" aria-modal="true" aria-label="V√≠deo">
      <div class="videoHead">
        <div class="videoTitle" id="videoTitle">üé• V√≠deo</div>
        <button class="videoClose" id="videoClose" type="button" aria-label="Fechar v√≠deo">‚úï</button>
      </div>
      <div class="videoBody">
        <div class="videoFrameWrap">
          <iframe
            class="videoFrame"
            id="videoFrame"
            title="Player de v√≠deo"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen
            referrerpolicy="strict-origin-when-cross-origin"
          ></iframe>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ======================
    // CONFIG / CONSTANTES
    // ======================
    const TECH_WHATS_NUMBER = "5516994241388";
    const TECH_WHATS_MESSAGE =
      "Gabriel, estamos com um problema t√©cnico, voc√™ pode nos ajudar?";

    // localStorage (apenas prefer√™ncias)
    const LS_MOBILE = "ieq_live_mobile_v2";
    const LS_QUERY  = "ieq_live_query_v2";

    // ======================
    // DADOS
    // ======================
    // DICA: Para adicionar v√≠deo em qualquer problema, basta preencher o campo:
    // video: "https://...."
    const DATA = [
      {
        stage: "ETAPA 1 ‚Äî ENERGIA / INICIALIZA√á√ÉO",
        problems: [
          { q: "Nada liga.", video: "https://youtu.be/zDcRNHwA9ic", solutions: [
            { text: "Verifique o disjuntor geral." },
            { text: "Confirme se o filtro de linha est√° ligado." },
            { text: "Verifique cabos de energia." }
          ]},
          { q: "C√¢mera n√£o liga.", video: "https://youtu.be/bBOUg-3p5ZU", solutions: [
            { text: "Conferir pilhas do controle." },
            { text: "Conferir se no controle est√° selecionada a PTZ 1 (apertar no bot√£o 1)." },
            { text: "Verificar cabo de energia da PTZ." },
            { text: "Retire da tomada e coloque novamente, ela vai ligar sozinha. Caso n√£o ligue, fa√ßa uma ora√ß√£o." }
          ]},
          { q: "C√¢mera liga mas n√£o d√° imagem.", video: "https://youtu.be/Xi2b-17VGbU", solutions: [
            { text: "Trocar de cena no OBS e voltar." },
            { text: "Verificar se a c√¢mera correta est√° selecionada no OBS." },
            { text: "Desligar e ligar a c√¢mera novamente." },
            { text: "Verificar se a c√¢mera est√° conectada no IP do roteador.", steps: [
              "Entre no navegador e digite: 192.168.3.30",
              "Se a p√°gina carregar, est√° tudo certo.",
              "Se n√£o carregar, voc√™ deve trocar o IP do roteador."
            ]},
            { text: "Trocar o IP do roteador (quando n√£o acessar 192.168.3.30).", steps: [
              "Digite no navegador: 192.168.3.1",
              "Se n√£o funcionar, troque apenas o terceiro n√∫mero: 192.168.4.1 / 192.168.5.1 / 192.168.6.1 (continue assim at√© conseguir entrar).",
              "Clique na op√ß√£o de configura√ß√µes de rede (LAN).",
              "Todos os IPs que come√ßarem com 192.168, troque o n√∫mero depois do terceiro ponto para 3.",
              "Exemplo: se estiver 192.168.10.1, altere para 192.168.3.1",
              "Voc√™ deve fazer isso em 3 √°reas diferentes dentro dessa mesma aba. Fique atento!",
              "Salve as configura√ß√µes.",
              "Reinicie o OBS.",
              "Aguarde 1 minuto.",
              "Tente novamente acessar: 192.168.3.30"
            ]},
            { text: "Verificar se a c√¢mera trocou de IP.", steps: [
              "Entre na pasta ‚ÄúConfigurador PTZ‚Äù na √°rea de trabalho.",
              "Inicie o aplicativo ‚ÄúConfigureTool‚Äù.",
              "Selecione a fonte de wifi ‚ÄúRealtek PCIe‚Äù.",
              "Clique em refresh.",
              "A c√¢mera deve aparecer, clique nela e em editar.",
              "Os ips que devem aparecer s√£o 192.168.3.1 e 192.168.3.30 respectivamente.",
              "Se estiver por exemplo ‚Äú192.168.10.1 e 192.168.10.30‚Äù, altere para os citados acima e salve."
            ]}
          ]},
          { q: "Computador n√£o abriu programas.", video: "https://youtu.be/5Sh9oqZm5DI", solutions: [
            { text: "Aguarde 2 minutos." },
            { text: "Reinicie o computador se necess√°rio." }
          ]}
        ]
      },

      {
        stage: "ETAPA 2 ‚Äî V√çDEO",
        problems: [
          { q: "Tela preta no OBS.", video: "https://youtu.be/3ZGi57yQg-U", solutions: [
            { text: "Verificar se a c√¢mera est√° ligada." },
            { text: "Trocar de cena e voltar." },
            { text: "Reiniciar OBS." }
          ]},
          { q: "Imagem travando.", video: "https://youtu.be/7IVuyDd_lHU", solutions: [
            { text: "Fechar programas desnecess√°rios." },
            { text: "Evitar abrir muitas abas do navegador." },
            { text: "Verifique a conex√£o com a internet.", steps: [
              "No Google digite ‚Äúteste de velocidade‚Äù.",
              "Clique no primeiro que aparecer e realize os testes.",
              "O UPLOAD deve estar acima de 400Mb, se n√£o estiver, reinicie o roteador."
            ]}
          ]},
          { q: "C√¢mera fora de posi√ß√£o.", video: "https://youtu.be/dPwxa7NYd48", solutions: [
            { text: "Altere a predefini√ß√£o no canto superior esquerdo do OBS." },
            { text: "Movimente a c√¢mera pelos n√∫meros: 8 ‚Äì 4 ‚Äì 6 e 2 ou use o zoom com o + e -" },
            { text: "Reinicie a c√¢mera" }
          ]}
        ]
      },

      {
        stage: "ETAPA 3 ‚Äî √ÅUDIO",
        problems: [
          { q: "N√£o entra √°udio no OBS.", video: "https://youtu.be/Az5k7Z3Lgg8", solutions: [
            { text: "Verificar se a interface de √°udio est√° ligada, se n√£o, mexa no cabo que vai at√© o computador." },
            { text: "Verificar se o √°udio chega at√© interface de √°udio, se n√£o, tire e coloque o cabo que sai do multicabo direito que est√° em baixo da mesa (Sempre use a √∫ltima entrada)." },
            { text: "Conferir se os microfones est√£o indo para o auxiliar AUDIO LIVE (FADERS -> AUDIO LIVE -> Verificar se o fader est√° levantado." },
            { text: "Conferir se o auxiliar AUDIO LIVE n√£o est√° mutado (AUX 1-8 -> Verifique se o AUDIO LIVE n√£o est√° com o M marcado em vermelho, se estiver, clique em cima e desmarque)." },
            { text: "Reiniciar OBS." }
          ]},
          { q: "Tem som no OBS mas n√£o no fone.", video: "https://youtu.be/3FFAijnukm0", solutions: [
            { text: "Verificar volume do fone." },
            { text: "Verificar conector do fone." },
            { text: "Verificar se ele est√° enviando o monitor para o fone.", steps: [
              "Clique nos 3 pontinhos na barra ‚Äúmesa de som‚Äù ao centro inferior da tela",
              "V√° em ‚ÄúPropriedades avan√ßadas de √°udio‚Äù",
              "No canal ‚ÄúMIC/AUX‚Äù em ‚ÄúMONITORAMENTE DO √ÅUDIO‚Äù selecione ‚ÄúMONITORAR E ENVIAR‚Äù"
            ]},
            { text: "Conferir se o √°udio est√° vindo do lugar certo.", steps: [
              "Clique nos 3 pontinhos na barra ‚Äúmesa de som‚Äù ao centro inferior da tela",
              "Clique em ‚Äúpropriedades‚Äù",
              "Selecione o dispositivo ‚ÄúHD-1‚Äù",
              "Se n√£o aparecer, desconecte a interface do computador, conecte novamente e reinicie o programa"
            ]}
          ]},
          { q: "Som estourado.", video: "https://youtu.be/-CO2iB1m4xc", solutions: [
            { text: "Diminuir fader do AUDIO LIVE." },
            { text: "Caso seja apenas uma voz, diminuir o volume individual no AUDIO LIVE" }
          ]},
          { q: "Som chiando.", video: "https://youtu.be/DdevKFly6dg", solutions: [
            { text: "Diminuir o knob da interface e aumentar o √°udio que AUDIO LIVE na mesa" },
            { text: "Movimentar o multicabo direito que est√° em baixo da mesa, se durante o movimento o chiado parar, tente deixar o muti cabo nessa posi√ß√£o" },
            { text: "Aumentar o cancelamento de ru√≠do no OBS", steps: [
              "Clique nos 3 pontinhos na barra ‚Äúmesa de som‚Äù ao centro inferior da tela",
              "V√° em ‚ÄúSupress√£o de ru√≠dos‚Äù",
              "E diminua a barra. Quanto menor, mais ela vai cortar o som.",
              "‚ö† No louvor, ela n√£o deve baixar menos que -6 dB (pode cortar instrumentos). Na prega√ß√£o, voc√™ pode diminuir mais, sem cortar a voz."
            ]}
          ]}
        ]
      },

      {
        stage: "ETAPA 4 ‚Äî MESA DE SOM",
        problems: [
          { q: "App n√£o encontra a mesa.", video: "https://youtu.be/KgpmZ_SmPMY", solutions: [
            { text: "Conferir Wi-Fi ‚ÄúMesa de Som‚Äù." },
            { text: "Se n√£o estiver conectado, use a senha: 03132628" },
            { text: "Clicar em Refresh" },
            { text: "Reiniciar a mesa no altar" }
          ]},
          { q: "Mesa n√£o conecta.", video: "https://youtu.be/KgpmZ_SmPMY", solutions: [
            { text: "Fechar e reabrir o aplicativo." },
            { text: "Tentar Connect novamente." },
            { text: "Desconectar e conectar novamente na rede da MESA" }
          ]},
          { q: "Louvor muito alto ou voz baixa.", video: "https://youtu.be/nUdgZ_jJMTM", solutions: [
            { text: "Ajustar faders do auxiliar AUDIO LIVE na categoria FADERS. (PRIORIZAR AS VOZES)" }
          ]}
        ]
      },

      {
        stage: "ETAPA 5 ‚Äî YOUTUBE / FACEBOOK",
        problems: [
          { q: "Contador n√£o aparece.", video: "https://youtu.be/4BrSAtkhCc8", solutions: [
            { text: "Conferir se OBS est√° na cena ‚ÄúIn√≠cio‚Äù." },
            { text: "Aguardar 30 segundos." },
            { text: "Atualizar a p√°gina." },
            { text: "Conferir chave de transmiss√£o" }
          ]},
          { q: "Chave de transmiss√£o indispon√≠vel", video: "https://youtu.be/681yFwY7vWQ", solutions: [
            { text: "Atualizar chave no YouTube Studio e colar no OBS.", steps: [
              "V√° at√© o Youtube Studio no navegador",
              "No preview da imagem no canto superior direito, procure por ‚ÄúChave de transmiss√£o‚Äù",
              "Selecione a chave ‚ÄúTRANSMISS√ÉO‚Äù",
              "Clique no √≠cone de copiar",
              "Entre no OBS -> CONFIGURA√á√ïES -> TRANSMISS√ÉO -> USAR CHAVE DE TRANSMISS√ÉO -> COLE A CHAVE"
            ]},
            { text: "Atualizar chave no Facebook e colar no plugin multi stream.", steps: [
              "No Facebook selecione ‚ÄúSoftware de streaming‚Äù, copie a chave e cole no plugin multi stream"
            ]}
          ]},
          { q: "YouTube funciona mas Facebook n√£o.", video: "https://youtu.be/8ZzBT1Rt0WI", solutions: [
            { text: "Atualizar p√°gina do Facebook." },
            { text: "Aguardar preview aparecer." },
            { text: "Clicar em ‚Äúiniciar transmiss√£o‚Äù" }
          ]}
        ]
      },

      {
        stage: "ETAPA 6 ‚Äî DURANTE O CULTO",
        problems: [
          { q: "Cena errada no ar.", video: "https://youtu.be/wx4gKptjOgM", solutions: [
            { text: "Trocar manualmente para a cena correta." }
          ]},
          { q: "Som caiu durante a palavra.", video: "https://youtu.be/wx4gKptjOgM", solutions: [
            { text: "Verificar barra do OBS. Se chegar na barra, est√° chegando na live" },
            { text: "Retirar e colocar o cabo do multicabo direito que fica em baixo da mesa, conecte no √∫ltimo canal" },
            { text: "Verificar em um aparelho externo se o som realmente caiu ou o fone parou de funcionar" }
          ]}
        ]
      },

      {
        stage: "ETAPA 7 ‚Äî ENCERRAMENTO",
        problems: [
          { q: "Live n√£o encerrou.", video: "https://youtu.be/zdLvXfjeJ2U", solutions: [
            { text: "Clicar novamente na cena ‚ÄúEncerrar‚Äù." },
            { text: "Confirmar no YouTube." },
            { text: "Confirmar no Facebook." }
          ]}
        ]
      },

      {
        stage: "PLANO DE EMERG√äNCIA",
        problems: [
          { q: "90% dos problemas s√£o resolvidos nesses passos.", video: "https://youtu.be/cn0C-bJ9PpU", solutions: [
            { text: "Reiniciar OBS." },
            { text: "Conferir c√¢mera." },
            { text: "Conferir √°udio." },
            { text: "Atualizar YouTube/Facebook." },
            { text: "Manter a calma." }
          ]}
        ]
      }
    ];

    // ======================
    // UTIL
    // ======================
    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }
    function waLink(number, message){
      const text = encodeURIComponent(message);
      return `https://wa.me/${number}?text=${text}`;
    }
    function norm(s){
      return String(s || "")
        .toLowerCase()
        .normalize("NFD")
        .replace(/[\u0300-\u036f]/g, "");
    }
    function highlight(text, query){
      const q = norm(query).trim();
      if(!q) return escapeHtml(text);

      const terms = q.split(/\s+/).filter(Boolean).slice(0, 3);
      const raw = String(text || "");
      let out = escapeHtml(raw);

      for(const t of terms){
        if(t.length < 2) continue;
        const re = new RegExp(`(${t.replace(/[.*+?^${}()|[\]\\]/g, "\\$&")})`, "ig");
        out = out.replace(re, "<mark>$1</mark>");
      }
      return out;
    }

    // ===== YouTube: extrai ID de youtu.be / watch?v= / shorts/ / embed/ =====
    function getYouTubeId(url){
      try{
        const u = new URL(String(url || "").trim());
        const host = u.hostname.replace(/^www\./,"");
        if(host === "youtu.be"){
          const id = u.pathname.replace("/","");
          return id || null;
        }
        if(host === "youtube.com" || host === "m.youtube.com" || host === "music.youtube.com"){
          // watch?v=
          const v = u.searchParams.get("v");
          if(v) return v;
          // shorts/
          const m1 = u.pathname.match(/\/shorts\/([A-Za-z0-9_-]{6,})/);
          if(m1) return m1[1];
          // embed/
          const m2 = u.pathname.match(/\/embed\/([A-Za-z0-9_-]{6,})/);
          if(m2) return m2[1];
        }
        return null;
      }catch(e){
        // se vier s√≥ o ID ou algo quebrado
        const s = String(url || "").trim();
        const m = s.match(/([A-Za-z0-9_-]{11})/);
        return m ? m[1] : null;
      }
    }
    function makeYouTubeEmbedUrl(videoUrl){
      const id = getYouTubeId(videoUrl);
      if(!id) return null;
      // autoplay + sem relateds excessivos + sem thumb (abre direto no player)
      return `https://www.youtube-nocookie.com/embed/${encodeURIComponent(id)}?autoplay=1&rel=0&modestbranding=1&playsinline=1`;
    }

    // ======================
    // ESTADO
    // ======================
    let query = "";
    let mobileMode = false;

    // ======================
    // MODAL V√çDEO (NOVO)
    // ======================
    const videoBackdrop = document.getElementById("videoBackdrop");
    const videoClose = document.getElementById("videoClose");
    const videoFrame = document.getElementById("videoFrame");
    const videoTitle = document.getElementById("videoTitle");

    function openVideo(videoUrl, titleText){
      closeHeaderMenu();
      closeEmergency();

      const embed = makeYouTubeEmbedUrl(videoUrl);
      if(!embed) return;

      videoTitle.textContent = titleText ? `üé• ${titleText}` : "üé• V√≠deo";
      videoFrame.src = embed;

      videoBackdrop.classList.add("show");
      videoBackdrop.setAttribute("aria-hidden","false");
      // trava scroll do fundo
      document.body.style.overflow = "hidden";
    }

    function closeVideo(){
      videoBackdrop.classList.remove("show");
      videoBackdrop.setAttribute("aria-hidden","true");
      // para o v√≠deo
      videoFrame.src = "";
      document.body.style.overflow = "";
    }

    videoClose.addEventListener("click", closeVideo);
    videoBackdrop.addEventListener("click", (e)=>{
      if(e.target === videoBackdrop) closeVideo();
    });

    // ======================
    // RENDER
    // ======================
    const app = document.getElementById("app");
    const resultCountEl = document.getElementById("resultCount");

    function problemTextBlob(stageTitle, problem){
      let blob = `${stageTitle}\n${problem.q}\n`;
      for(const s of (problem.solutions || [])){
        blob += (s.text || "") + "\n";
        if(Array.isArray(s.steps)) blob += s.steps.join("\n") + "\n";
      }
      return blob;
    }

    function problemMatches(stageTitle, problem, q){
      const nq = norm(q).trim();
      if(!nq) return true;
      const blob = norm(problemTextBlob(stageTitle, problem));
      const tokens = nq.split(/\s+/).filter(Boolean).slice(0, 5);
      return tokens.every(t => blob.includes(t));
    }

    function render(){
      let totalVisibleProblems = 0;

      app.innerHTML = DATA.map((stage, si)=>{
        const filteredProblems = stage.problems
          .map((p, pi)=>({p, pi}))
          .filter(({ p }) => problemMatches(stage.stage, p, query));

        if(filteredProblems.length === 0) return "";

        totalVisibleProblems += filteredProblems.length;
        const items = filteredProblems.length;

        return `
          <section class="stage" data-stage="${si}">
            <div class="stageHead">
              <div class="left">
                <p class="title">${escapeHtml(stage.stage)}</p>
                <div class="hint">Toque no problema para abrir/fechar.</div>
              </div>
              <div class="chip">${items} problema(s)</div>
            </div>
            <div class="problemList">
              ${filteredProblems.map(({ p, pi }) => renderProblem(si, pi, stage.stage, p)).join("")}
            </div>
          </section>
        `;
      }).join("") || `
        <div style="margin-top:16px;border:1px solid rgba(255,255,255,.14);background: rgba(0,0,0,.16);border-radius: 20px;padding:12px;box-shadow: var(--shadow2);">
          <b style="color: rgba(255,255,255,.95)">Nenhum resultado.</b>
          <div style="margin-top:6px;color: rgba(255,255,255,.74);font-weight:900;font-size:12.5px">
            Tente termos mais simples (ex: ‚Äú√°udio‚Äù, ‚Äúmesa‚Äù, ‚Äútravando‚Äù, ‚Äúchave‚Äù).
          </div>
        </div>
      `;

      resultCountEl.textContent = String(totalVisibleProblems);
      bindEvents();
      openProblemFromHash();
}

    function renderProblem(si, pi, stageTitle, p){
      const totalSolutions = (p.solutions || []).length;
      const qHtml = highlight(p.q, query);

      const hasVideo = typeof p.video === "string" && p.video.trim().length > 0;
      const videoHref = hasVideo ? p.video.trim() : "#";

      return `
        <article class="problem" data-problem="${si}:${pi}">
          <div class="problemTop" role="button" tabindex="0" aria-label="Abrir problema">
            <div class="rowLeft">
              <p class="q"><span class="qIcon">?</span>${qHtml}</p>
            </div>
            <div class="rowRight">
              <div class="miniNav" aria-hidden="true">
                <div class="miniLabel">
                  <span class="muted">Poss√≠veis solu√ß√µes:</span>&nbsp;<span class="num">${totalSolutions}</span>
                </div>
                <div class="miniArrow">‚Ä∫</div>
              </div>
            </div>
          </div>

          <div class="problemBody">
            <div class="solutionsHeader">
              <div class="bulletTitle">‚Ä¢ Solu√ß√µes poss√≠veis</div>
              <div class="right">Tente uma por vez</div>
            </div>

            ${(p.solutions || []).map((s, idx)=>renderSolution(si, pi, idx, s)).join("")}

            <div class="actions">
              <a
                class="smallBtn video ${hasVideo ? "" : "disabled"}"
                href="${escapeHtml(videoHref)}"
                target="_blank"
                rel="noopener"
                aria-disabled="${hasVideo ? "false" : "true"}"
                title="${hasVideo ? "Abrir v√≠deo deste problema" : "Sem v√≠deo ainda (adicione o link no DATA)"}"
                data-video="${hasVideo ? escapeHtml(videoHref) : ""}"
                data-videotitle="${escapeHtml(p.q || "V√≠deo")}"
              >
                üé• Ver v√≠deo
              </a>

              <a class="smallBtn" href="${waLink(TECH_WHATS_NUMBER, TECH_WHATS_MESSAGE)}" target="_blank" rel="noopener">
                üí¨ WhatsApp
              </a>
            </div>
          </div>
        </article>
      `;
    }

    function renderSolution(si, pi, idx, s){
      const hasSteps = Array.isArray(s.steps) && s.steps.length > 0;
      const textHtml = highlight(s.text || "", query);

      return `
        <div class="solution ${hasSteps ? "" : "noSteps"}" data-solution="${si}:${pi}:${idx}">
          <div class="solutionTop" role="button" tabindex="0" aria-label="${hasSteps ? "Abrir detalhe da solu√ß√£o" : "Solu√ß√£o"}">
            <div class="left">
              <div class="dot" aria-hidden="true">‚Ä¢</div>
              <div class="solText">${textHtml}</div>
            </div>
            ${hasSteps ? `<div class="solChev" aria-hidden="true">‚Ä∫</div>` : ``}
          </div>

          ${hasSteps ? `
            <div class="solutionBody">
              <ul class="steps">
                ${s.steps.map(line => `
                  <li>
                    <span class="arr">‚Üí</span>
                    <span>${highlight(line, query)}</span>
                  </li>
                `).join("")}
              </ul>
            </div>
          ` : ``}
        </div>
      `;
    }

    // ======================
    // INTERA√á√ïES
    // ======================
    function closeAllProblems(){
      document.querySelectorAll(".problem.open").forEach(p=>p.classList.remove("open"));
      document.querySelectorAll(".solution.open").forEach(s=>s.classList.remove("open"));
    
      history.replaceState(null,"",location.pathname+location.search);
    }

    function closeOtherProblems(currentWrap){
      document.querySelectorAll(".problem.open").forEach(p=>{
        if(p !== currentWrap) p.classList.remove("open");
      });
    }

    function closeOtherSolutionsWithin(problemWrap, currentSolution){
      problemWrap.querySelectorAll(".solution.open").forEach(s=>{
        if(s !== currentSolution) s.classList.remove("open");
      });
    }

    // ===== HASH HELPERS =====
    function slugify(str){
      return norm(str)
        .replace(/[^a-z0-9]+/g, "-")
        .replace(/^-+|-+$/g, "");
    }

    function setHashFromProblem(problemWrap){
      const qEl = problemWrap ? problemWrap.querySelector(".q") : null;
      if(!qEl) return;
      const slug = slugify(qEl.textContent || "");
      if(!slug) return;
      history.replaceState(null, "", "#" + slug);
    }

    function openProblemFromHash(){
      const h = (window.location.hash || "").replace("#","");
      if(!h) return;

      const problems = document.querySelectorAll(".problem");
      problems.forEach(p=>{
        const qEl = p.querySelector(".q");
        if(!qEl) return;
        const slug = slugify(qEl.textContent || "");
        if(slug === h){
          closeOtherProblems(p);
          p.classList.add("open");
          // fecha solu√ß√µes abertas (se existirem) para manter estado limpo
          p.querySelectorAll(".solution.open").forEach(s=>s.classList.remove("open"));
        }
      });
    }



    function bindEvents(){
      // Problemas (accordion: abre um e fecha os outros)
      document.querySelectorAll(".problemTop").forEach(el=>{
        el.addEventListener("click", ()=>{
          const wrap = el.closest(".problem");
          const willOpen = !wrap.classList.contains("open");

			if(willOpen){
              closeOtherProblems(wrap);
              wrap.classList.add("open");
              setHashFromProblem(wrap);
            }else{
              // fechando: limpa hash se for este problema
              const qEl = wrap.querySelector(".q");
              if(qEl){
                const slug = slugify(qEl.textContent||"");
                const cur = (location.hash||"").replace("#","");
                if(slug && cur===slug){
                  history.replaceState(null,"",location.pathname+location.search);
                }
              }
              wrap.classList.remove("open");
              wrap.querySelectorAll(".solution.open").forEach(s=>s.classList.remove("open"));
            }
		  });

        el.addEventListener("keydown", (e)=>{
          if(e.key === "Enter" || e.key === " "){
            e.preventDefault();
            el.click();
          }
        });
      });

      // Solu√ß√µes (accordion dentro do problema) ‚Äî s√≥ abre se tiver steps
      document.querySelectorAll(".solutionTop").forEach(el=>{
        el.addEventListener("click", ()=>{
          const solWrap = el.closest(".solution");
          const probWrap = el.closest(".problem");
          const hasBody = !!solWrap.querySelector(".solutionBody");
          if(!hasBody) return;

          const willOpen = !solWrap.classList.contains("open");
          if(willOpen){
            closeOtherSolutionsWithin(probWrap, solWrap);
            solWrap.classList.add("open");
          }else{
            solWrap.classList.remove("open");
          }
        });

        el.addEventListener("keydown", (e)=>{
          if(e.key === "Enter" || e.key === " "){
            e.preventDefault();
            el.click();
          }
        });
      });

      // V√≠deo: intercepta clique e abre modal (sem mudar o bot√£o)
      document.querySelectorAll("a.smallBtn.video").forEach(a=>{
        a.addEventListener("click", (e)=>{
          const isDisabled = a.classList.contains("disabled") || a.getAttribute("aria-disabled") === "true";
          if(isDisabled) return;

          e.preventDefault(); // impede abrir nova aba
          const url = a.getAttribute("data-video") || a.getAttribute("href");
          const title = a.getAttribute("data-videotitle") || "V√≠deo";
          openVideo(url, title);
        });
      });
    }

    // ======================
    // BUSCA
    // ======================
    const searchInput = document.getElementById("searchInput");
    const btnClearSearch = document.getElementById("btnClearSearch");

    function setQuery(q){
      query = q || "";
      try{ localStorage.setItem(LS_QUERY, query); }catch(e){}
      closeAllProblems();
      render();
    }

    searchInput.addEventListener("input", ()=> setQuery(searchInput.value));

    btnClearSearch.addEventListener("click", ()=>{
      searchInput.value = "";
      setQuery("");
      searchInput.focus();
    });

    searchInput.addEventListener("keydown", (e)=>{
      if(e.key === "Enter"){
        const first = document.querySelector(".problem .problemTop");
        if(first){
          e.preventDefault();
          first.click();
        }
      }
    });

    // ======================
    // MODO CELULAR
    // ======================
    const btnMobile = document.getElementById("btnMobile");
    const btnMobile_m = document.getElementById("btnMobile_m");

    function syncMobileButtons(){
      const label = mobileMode ? "üì± Modo celular: ON" : "üì± Modo celular: OFF";
      if(btnMobile){
        btnMobile.textContent = label;
        btnMobile.classList.toggle("primary", mobileMode);
      }
      if(btnMobile_m){
        btnMobile_m.textContent = label;
        btnMobile_m.classList.toggle("primary", mobileMode);
      }
    }

    function setMobileMode(on){
      mobileMode = !!on;
      document.body.classList.toggle("mobileMode", mobileMode);
      syncMobileButtons();
      try{ localStorage.setItem(LS_MOBILE, mobileMode ? "1" : "0"); }catch(e){}
    }

    if(btnMobile) btnMobile.addEventListener("click", ()=> setMobileMode(!mobileMode));
    if(btnMobile_m) btnMobile_m.addEventListener("click", ()=> setMobileMode(!mobileMode));

    // ======================
    // EMERG√äNCIA (modal)
    // ======================
    const modalBackdrop = document.getElementById("modalBackdrop");
    const modalClose = document.getElementById("modalClose");
    const modalOk = document.getElementById("modalOk");
    const btnEmergency = document.getElementById("btnEmergency");
    const btnEmergency_m = document.getElementById("btnEmergency_m");
    const btnWhats = document.getElementById("btnWhats");
    const btnWhats_m = document.getElementById("btnWhats_m");
    const modalWhats = document.getElementById("modalWhats");

    const whatsHref = waLink(TECH_WHATS_NUMBER, TECH_WHATS_MESSAGE);
    btnWhats.href = whatsHref;
    btnWhats_m.href = whatsHref;
    modalWhats.href = whatsHref;

    function openEmergency(){
      closeHeaderMenu();
      modalBackdrop.style.display = "grid";
      modalBackdrop.style.placeItems = "center";
      modalBackdrop.setAttribute("aria-hidden","false");
      document.body.style.overflow = "hidden";
    }
    function closeEmergency(){
      modalBackdrop.style.display = "none";
      modalBackdrop.setAttribute("aria-hidden","true");
      document.body.style.overflow = "";
    }

    if(btnEmergency) btnEmergency.addEventListener("click", openEmergency);
    if(btnEmergency_m) btnEmergency_m.addEventListener("click", openEmergency);
    modalClose.addEventListener("click", closeEmergency);
    modalOk.addEventListener("click", closeEmergency);
    modalBackdrop.addEventListener("click", (e)=>{
      if(e.target === modalBackdrop) closeEmergency();
    });

    // ======================
    // MENU ‚ãÆ (mobile)
    // ======================
    const menuBtn = document.getElementById("menuBtn");
    const headerMenu = document.getElementById("headerMenu");
    const menuOverlay = document.getElementById("menuOverlay");
    const menuClose = document.getElementById("menuClose");

    function openHeaderMenu(){
      headerMenu.classList.add("show");
      menuOverlay.classList.add("show");
      menuOverlay.setAttribute("aria-hidden","false");
      menuBtn.setAttribute("aria-expanded","true");
    }
    function closeHeaderMenu(){
      headerMenu.classList.remove("show");
      menuOverlay.classList.remove("show");
      menuOverlay.setAttribute("aria-hidden","true");
      menuBtn.setAttribute("aria-expanded","false");
    }
    function toggleHeaderMenu(){
      const isOpen = headerMenu.classList.contains("show");
      if(isOpen) closeHeaderMenu();
      else openHeaderMenu();
    }

    menuBtn.addEventListener("click", (e)=>{
      e.stopPropagation();
      toggleHeaderMenu();
    });
    menuOverlay.addEventListener("click", closeHeaderMenu);
    menuClose.addEventListener("click", closeHeaderMenu);

    headerMenu.addEventListener("click", (e)=>{
      const t = e.target;
      if(t && (t.tagName === "A" || t.tagName === "BUTTON")){
        setTimeout(closeHeaderMenu, 0);
      }
    });

    // ======================
    // INIT
    // ======================
    document.getElementById("year").textContent = new Date().getFullYear();

    try{
      const rawQuery = localStorage.getItem(LS_QUERY);
      if(typeof rawQuery === "string") query = rawQuery;
    }catch(e){}
    try{
      const mm = localStorage.getItem(LS_MOBILE);
      if(mm === "1") mobileMode = true;
    }catch(e){}

    searchInput.value = query;
    setMobileMode(mobileMode);

    render();

    // ===== HEADER SHRINK ON SCROLL (com histerese, sem ‚Äúoscilar‚Äù) =====
    (function(){
      const header = document.querySelector("header");
      if(!header) return;

      let ticking = false;
      let compact = false;

      const ENTER_Y = 70;
      const EXIT_Y  = 20;

      function update(){
        ticking = false;
        if(document.body.classList.contains("mobileMode")){
          header.classList.remove("compact");
          compact = false;
          return;
        }
        const y = window.scrollY || 0;
        if(!compact && y > ENTER_Y){
          compact = true;
          header.classList.add("compact");
        }else if(compact && y < EXIT_Y){
          compact = false;
          header.classList.remove("compact");
        }
      }

      function onScroll(){
        if(!ticking){
          ticking = true;
          requestAnimationFrame(update);
        }
      }

      window.addEventListener("scroll", onScroll, {passive:true});
      update();
    })();

    // ===== ESC fecha tudo corretamente =====
    document.addEventListener("keydown", (e)=>{
      if(e.key === "Escape"){
        closeHeaderMenu();
        closeEmergency();
        closeAllProblems();
        closeVideo();
      }
    });
	


  </script>
</body>
</html>


